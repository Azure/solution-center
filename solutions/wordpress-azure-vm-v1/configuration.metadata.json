{
    "$schema": "../../definitions/configuration.metadata.schema.json",
    "overviewContent": "This solution deploys an autoscaling web frontend layer (with nginx and PHP-FPM), private Virtual Network for frontend instances, controller VM running cron and handling syslog for the autoscaling cluster, Azure Load balancer to balance across the autoscaling instances, Azure Database for MySQL or Azure Database for PostgreSQL or Azure SQL Database, and Dual GlusterFS nodes or NFS for highly available access to LAMP files.",
    "documentationFileName": "wordpress-readme.md",
    "supportsManualConfiguration": false,
    "associatedResources": [
        {
            "resourceType": "Microsoft.Network/PublicIpAddresses",
            "type": "AzureResource"
        },
        {
            "resourceType": "Microsoft.Network/virtualNetworks",
            "type": "AzureResource"
        },
        {
            "resourceType": "Microsoft.Network/NetworkSecurityGroups",
            "type": "AzureResource"
        },
        {
            "resourceType": "Microsoft.Compute/disks",
            "type": "AzureResource"
        },
        {
            "resourceType": "Microsoft.Compute/sshPublicKeys",
            "type": "AzureResource"
        },
        {
            "resourceType": "Microsoft.Network/networkinterfaces",
            "type": "AzureResource"
        },
        {
            "resourceType": "Microsoft.DBforMySQL/flexibleServers",
            "type": "AzureResource"
        },
        {
            "resourceType": "Microsoft.Cache/Redis",
            "type": "AzureResource"
        },
        {
            "resourceType": "Microsoft.Network/applicationGateways",
            "type": "AzureResource"
        },
        {
            "resourceType": "Microsoft.Compute/virtualMachines",
            "type": "AzureResource"
        },
        {
            "resourceType": "Microsoft.Compute/virtualMachineScaleSets",
            "type": "AzureResource"
        },
        {
            "resourceType": "Microsoft.Storage/StorageAccounts",
            "type": "AzureResource"
        }
    ],
    "pivots": [
        {
            "name": "virtualMachineCompute",
            "type": "AzureResource",
            "azureResourceType": "Microsoft.Compute/virtualMachines"
        },
        {
            "name": "vmssCompute",
            "type": "AzureResource",
            "azureResourceType": "Microsoft.Compute/virtualMachineScaleSets"
        },
        {
            "name": "databasePivot",
            "type": "AzureResource",
            "azureResourceType": "Microsoft.DBforMySQL/servers"
        },
        {
            "name": "storagePivot",
            "type": "AzureResource",
            "azureResourceType": "Microsoft.Storage/StorageAccounts"
        },
        {
            "name": "cachingPivot",
            "type": "AzureResource",
            "azureResourceType": "Microsoft.Cache/Redis"
        }
    ],
    "configurations": [
        {
            "id": "base",
            "title": "Dev/Test instance",
            "subTitle": "A starter solution for quick setup with low-scale.",
            "cost": {
                "value": 110,
                "currency": "USD",
                "type": "absolute",
                "cadence": "monthly"
            },
            "maintenance": {
                "score": 1,
                "tooltip": "The expected maintenance overhead associated with managing this configuration."
            },
            "templateFileName": "azuredeploy-minimal.json",
            "pivotValues": [
                {
                    "pivotName": "virtualMachineCompute",
                    "content": [
                        "2 D1v2 (1 vCPU, 3.5 GB RAM) VMs without any scale option",
                        "Uses NFS, MySQL, and smaller autoscale web frontend VM sku (1 core)",
                        "Requires only 2 VM cores",
                        "Works with free trial subscriptions",
                        "32 GiB P4 managed disk"
                    ]
                }
            ]
        },
        {
            "id": "small",
            "title": "Small to Mid-Size",
            "subTitle": "Supporting up to 1,000 concurrent users.",
            "cost": {
                "value": 975,
                "currency": "USD",
                "type": "absolute",
                "cadence": "monthly"
            },
            "maintenance": {
                "score": 2,
                "tooltip": "The expected maintenance overhead associated with managing this configuration."
            },
            "templateFileName": "azuredeploy-small2mid-noha.json",
            "pivotValues": [
                {
                    "pivotName": "virtualMachineCompute",
                    "content": [
                        "3 D-Series VMs, one as controller VM",
                        "4 P10 128 GiB Disks, with Standard HDD"
                    ]
                },
                {
                    "pivotName": "databasePivot",
                    "content": [
                        "Gen 5 8 vCore Azure Database for MySQL",
                        "Backup enabled"
                    ]
                },
                {
                    "pivotName": "storagePivot",
                    "content": [
                        "128 GiB Storage"
                    ]
                }
            ]
        },
        {
            "id": "large",
            "title": "Full Production Workload",
            "subTitle": "Supports thousands of concurrent users, HA, and caching.",
            "cost": {
                "value": 3450,
                "currency": "USD",
                "type": "absolute",
                "cadence": "monthly"
            },
            "maintenance": {
                "score": 3,
                "tooltip": "The expected maintenance overhead associated with managing this configuration."
            },
            "templateFileName": "azuredeploy-maximal.json",
            "pivotValues": [
                {
                    "pivotName": "virtualMachineCompute",
                    "content": [
                        "8 D-Series VMs, one as controller VM",
                        "Standard SSDs with LRS",
                        "Estimated with 100,000 storage transactions per VM"
                    ]
                },
                {
                    "pivotName": "databasePivot",
                    "content": [
                        "Gen 5 16 vCore Azure Database for MySQL",
                        "Backup enabled"
                    ]
                },
                {
                    "pivotName": "storagePivot",
                    "content": [
                        "128 GiB Storage"
                    ]
                },
                {
                    "pivotName": "cachingPivot",
                    "content": [
                        "Premium tier, 1 Shard per Instance",
                        "1 Additional Replica per Shard, 1 P1 instance"
                    ]
                }
                
            ]
        }
    ]
}